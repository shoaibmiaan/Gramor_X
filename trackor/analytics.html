<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Performance & Analytics</title>
  <style>
    :root{ --bg:#0b0c10; --card:#111319; --text:#e8eaed; --muted:#a7b0bf; --border:#232733; --acc:#3b82f6; --ok:#10b981; --warn:#f59e0b; }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
    .wrap,.container{max-width:1200px;margin:0 auto;padding:20px}
    h1,h2{margin:0 0 12px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px;margin:12px 0}
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin:10px 0 14px}
    .chip{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border:1px solid var(--border);border-radius:999px;background:#151826;font-size:12px;color:#cfd5e3}
    a.link{color:var(--acc);text-decoration:none;border-bottom:1px dashed var(--acc)}
    a.link:hover{opacity:.9}
    .badge{display:inline-block;font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid var(--border)}
    .badge.ok{background:#0f1d17;color:#a9efd4}
    .badge.warn{background:#241c0f;color:#f5d39e}
    ul{line-height:1.5}
    nav{display:flex;flex-wrap:wrap;gap:10px;margin:8px 0 16px}
    nav a{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:6px 10px;color:var(--text);text-decoration:none}
  </style>
</head>
<body>
<div class="container">
<nav><a href="user.html">User Module</a>
<a href="listening.html">Listening Module</a>
<a href="reading.html">Reading Module</a>
<a href="writing.html">Writing Module</a>
<a href="speaking.html">Speaking Module</a>
<a href="learning.html">Learning Module</a>
<a href="analytics.html">Performance & Analytics</a>
<a href="teacher-admin.html">Teacher/Admin Module</a>
<a href="admin-dashboard.html">Admin Dashboard</a>
<a href="ai-sidebar.html">AI Sidebar / Coach</a>
<a href="community.html">Community & Support</a>
<a href="monetization.html">Monetization</a>
<a href="qa.html">QA &amp; Testing</a>
<a href="platform-ops.html">Platform Ops</a></nav>

<h1>Performance & Analytics</h1>
  <div class="card"><b>Status:</b> Success dashboards online. Metrics refresh every 15 minutes via <code>/api/analytics/success-metrics</code>.</div>
  <div class="chips">
    <span class="chip">Exam Room</span>
    <span class="chip">Practice</span>
    <span class="chip">AI Feedback</span>
    <span class="chip">Review</span>
    <span class="chip">Analytics</span>
  </div>
  <p class="muted">Deep links:
    <a class="link" href="/analytics">/analytics</a> ·
    <a class="link" href="/analytics/test/1">/analytics/test/1</a> ·
    <a class="link" href="/analytics/test/1/review">/analytics/test/1/review</a>
  </p>

  <section class="card">
    <h2>Phase 7 Success Metrics</h2>
    <p>The dashboard aggregates 28 days of review, challenge, and retention data. Targets are embedded as guardrails; if a metric drops below target it is flagged in red.</p>
    <table style="width:100%;margin-top:12px;border-collapse:collapse;font-size:14px;">
      <thead>
        <tr style="text-align:left;color:#9ca3af;">
          <th style="padding:6px 8px;border-bottom:1px solid var(--border);">Metric</th>
          <th style="padding:6px 8px;border-bottom:1px solid var(--border);">Target</th>
          <th style="padding:6px 8px;border-bottom:1px solid var(--border);">Live value</th>
          <th style="padding:6px 8px;border-bottom:1px solid var(--border);">Notes</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="padding:6px 8px;">DAU review-completion rate</td>
          <td style="padding:6px 8px;">≥ 55%</td>
          <td style="padding:6px 8px;">Computed from <code>review_events</code> (open → complete)</td>
          <td style="padding:6px 8px;">Guardrail pauses experiments if the rate dips below the threshold.</td>
        </tr>
        <tr>
          <td style="padding:6px 8px;">Avg reviews / user / day</td>
          <td style="padding:6px 8px;">≥ 12</td>
          <td style="padding:6px 8px;">7-day average of completions per active user-day</td>
          <td style="padding:6px 8px;">Uses <code>review_events</code> completions only.</td>
        </tr>
        <tr>
          <td style="padding:6px 8px;">7-day retention uplift</td>
          <td style="padding:6px 8px;">+8–12% vs baseline</td>
          <td style="padding:6px 8px;">Compares control vs. variant cohorts on the spaced-interval experiment</td>
          <td style="padding:6px 8px;">Baseline and current windows auto-roll every day.</td>
        </tr>
        <tr>
          <td style="padding:6px 8px;">Words mastered / week</td>
          <td style="padding:6px 8px;">≥ 18</td>
          <td style="padding:6px 8px;">Average completions in <code>user_word_logs</code> per active learner</td>
          <td style="padding:6px 8px;">Feeds progress reporting and quota nudges.</td>
        </tr>
        <tr>
          <td style="padding:6px 8px;">Collocation accuracy delta</td>
          <td style="padding:6px 8px;">+0.15 in 2 weeks</td>
          <td style="padding:6px 8px;">Correct / attempts from <code>collocation_attempts</code></td>
          <td style="padding:6px 8px;">Tracks improvement between trailing 14-day windows.</td>
        </tr>
      </tbody>
    </table>
  </section>

  <section class="card">
    <h2>A/B Experiments & Guardrails</h2>
    <ul>
      <li><b>Spaced intervals A vs B</b>: Running. Assignments stored in <code>experiment_assignments</code>; guardrail auto-pauses when review completion drops below 55%.</li>
      <li><b>Collocation-first vs word-first</b>: Planned. Instrumentation in place, launches after interval test stabilises.</li>
      <li><b>Challenge notifications on/off</b>: Planned. Ready to flip once the retention uplift target is reliably green.</li>
    </ul>
    <p class="muted">The <code>/api/analytics/success-metrics</code> endpoint also toggles experiment status and assignment guardrails when metrics breach thresholds, making rollback automatic.</p>
  </section>

  <section class="card">
    <h2>Data Sources</h2>
    <ul>
      <li><code>review_events</code>: Instrumented from the word-of-the-day APIs to capture open/completion funnels.</li>
      <li><code>user_word_logs</code>: Weekly mastered counts for words and retention.</li>
      <li><code>collocation_attempts</code>: Challenge increments with attempt metadata for accuracy tracking.</li>
      <li><code>experiments</code> &amp; <code>experiment_assignments</code>: Experiment registry, status, and per-user variant.</li>
    </ul>
  </section>

</div>
</body>
</html>
